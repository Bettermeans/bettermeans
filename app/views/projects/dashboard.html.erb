<%= javascript_include_tag  'jquery.ui.position' %>
<%= stylesheet_link_tag 'dashboard' %>
<%= javascript_include_tag 'dashboard' %>

<!--[if lt IE 7]>
<div style='border: 1px solid #F7941D; background: #FEEFDA; text-align: center; clear: both; height: 75px; position: relative;'>
  <div style='position: absolute; right: 3px; top: 3px; font-family: courier new; font-weight: bold;'><a href='#' onclick='javascript:this.parentNode.parentNode.style.display="none"; return false;'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-cornerx.jpg' style='border: none;' alt='Close this notice'/></a></div>
  <div style='width: 640px; margin: 0 auto; text-align: left; padding: 0; overflow: hidden; color: black;'>
    <div style='width: 75px; float: left;'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-warning.jpg' alt='Warning!'/></div>
    <div style='width: 275px; float: left; font-family: Arial, sans-serif;'>
      <div style='font-size: 14px; font-weight: bold; margin-top: 12px;'>You are using an unsuported browser</div>
      <div style='font-size: 12px; margin-top: 6px; line-height: 12px;'>For a better experience using this site, please switch to a supported web browser.</div>
    </div>
    <div style='width: 75px; float: left;'><a href='http://www.firefox.com' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-firefox.jpg' style='border: none;' alt='Get Firefox 3.5'/></a></div>
    <div style='width: 73px; float: left;'><a href='http://www.apple.com/safari/download/' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-safari.jpg' style='border: none;' alt='Get Safari 4'/></a></div>
    <div style='float: left;'><a href='http://www.google.com/chrome' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-chrome.jpg' style='border: none;' alt='Get Google Chrome'/></a></div>
  </div>
</div>
<![endif]-->

<!-- <div style="background-color:#fff" id="dash_main"> -->
<div id="dash_main">
  <%= help_section("project_dashboard") %>
<!-- todo: do we need this link? -->
<div id='loading' class='loading'>
  <%= l(:text_loading_dashboard) %>
</div>
<div id='loading_error' style='display:none;text-weight:bold;'>
  <%= l(:text_loading_dashboard_error) %>
</div>
<div id='load_dashboard' style="display:none;text-align:center;width:100%">
  <table class="centeredTable"><tr><td>
    <a href="#" onclick="load_dashboard();return false;">Load Dashboard</a>
  </td></tr></table>
</div>
<!-- <div id='quote' style="display:none;text-align:center;width:100%">
  <table class="centeredTable"><tr><td>
  <%# @quote = Quote.random  %>
  <%#= @quote.body  %><br>
  ~<%#= @quote.author  %>
  </td></tr></table>
</div> -->
<div id='filtered_message' style="display:none;" class="filtered-message">
  Filtered results&nbsp;<span id="filter_detail" style="font-weight:bold;"></span>
  &nbsp;&nbsp;&nbsp;&nbsp;<a onclick="clear_filters();return false;" class="clickable bold">Clear</a>
</div>
<div id='panels' style="display: none;">
  <table id='main_table' class='dashboard' style='height: 100%;'>
    <tr id='main_row'>
      
    </tr>
  </table>
</div>

<% content_for :searchbar do %>
<div class="gt-search-container">
  <div class="dash-filter">
    <select id="filter_select" class="filter-search" onchange="filter_select();return false;">
      <option value="all">
        Filter (show all)
      </option>
      <option value="all">
        Items that I&nbsp;&nbsp;»
      </option>
      <option value="untouched_by_me">
        &nbsp;&nbsp;» didn't touch
      </option>
      <option value="touched_by_me">
        &nbsp;&nbsp;» touched
      </option>
      <option value="added_by_me">
        &nbsp;&nbsp;» added
      </option>
      <option value="prioritized">
        &nbsp;&nbsp;» prioritized
      </option>
      <option value="all">
        Needs my&nbsp;&nbsp;»
      </option>
      <option value="unagreed">
        &nbsp;&nbsp;» agreement
      </option>
      <option value="unestimated">
        &nbsp;&nbsp;» estimate
      </option>
      <option value="unaccepted">
        &nbsp;&nbsp;» acceptance
      </option>
      <option value="unprioritized">
        &nbsp;&nbsp;» prioritization
      </option>
      <option value="all">
        Updated in last&nbsp;&nbsp;»
      </option>
      <option value="1">
        &nbsp;&nbsp;» 24 hours
      </option>
      <option value="2">
        &nbsp;&nbsp;» two days
      </option>
      <option value="3">
        &nbsp;&nbsp;» three days
      </option>
      <option value="7">
        &nbsp;&nbsp;» week
      </option>
      <option value="14">
        &nbsp;&nbsp;» two weeks
      </option>
      <option value="30">
        &nbsp;&nbsp;» month
      </option>
      <option value="60">
        &nbsp;&nbsp;» two months
      </option>
      <option value="all">
        Only show&nbsp;&nbsp;»
      </option>
      <option value="features">
        &nbsp;&nbsp;»&nbsp;Features
      </option>
      <option value="chores">
        &nbsp;&nbsp;»&nbsp;Chores
      </option>
      <option value="bugs">
        &nbsp;&nbsp;»&nbsp;Bugs
      </option>
      <option value="recurring">
        &nbsp;&nbsp;»&nbsp;Recurring
      </option>
      <% if @project.credits_enabled? %>
        <option value="expenses">
          &nbsp;&nbsp;»&nbsp;Expenses
        </option>
        <option value="gifts">
          &nbsp;&nbsp;»&nbsp;Gifts
        </option>
        <option value="hourly">
          &nbsp;&nbsp;»&nbsp;Hourly
        </option>
      <% end %>
    </select>
  </div>
  
<div class="gt-search gt-search-narrow">
  <div class="gt-search-inner">
    <input id="fast_search" type="text" class="gt-search-text fast-search" autocomplete="off" size="20" name="searchString" value="" onblur="searching = false;" onfocus = "searching = true;">
    <!-- <table class="searchField">
      <tbody>
        <tr>
          <td>
            <a onclick="$(\'searchString\').focus(); return false;" href="#"><img src="/images/search_left.png" alt="Search" title=""></a>
          </td>
          <td class="field">
            
          </td>
          <td style="vertical-align:top;">
            <img src="/images/search_right.png">
          </td>
        </tr>
      </tbody>
    </table> -->
  </div>
  </div>
</div>


  <a id="new_request" onclick="new_item();return false;" class="dashboard-button">
    <div class="new_request_button">New Item</div>
  </a>

  <a id="refresh_data" onclick="refresh_local_data();return false;" class="dashboard-button">
    <div class="refresh_button"></div>
  </a>
  
  
<% end %>

<% content_for :buttonbar do %>
<div id="panel_buttons">
</div>
<% end %>


<script>
  var projectId = '<%= @project.identifier %>';
  var currentUser = '<%= User.current.name %>';
  var currentUserLogin = '<%= User.current.login %>';
  var currentUserId = '<%= User.current.id %>';
  var currentUserIsCitizen = '<%= User.current.core_member_of?(@project) %>';
  var currentUserIsMember = '<%= User.current.member_of?(@project) %>';
  var show_issue_id = '<%= @show_issue_id %>';
  var show_retro_id = '<%= @show_retro_id %>';
  var credit_base = '<%= @credit_base %>';
  var point_factor = <%= Setting::POINT_FACTOR.to_json %>;
  var credits_to_points_array = <%= Setting::CREDITS_TO_POINTS.to_json %>;
  var startable_priority_tiers = <%= Setting::NUMBER_OF_STARTABLE_PRIORITY_TIERS %>;
  var credits_enabled = <%= @project.credits_enabled? %>

  var standard_trackers = function() {
      var trackers = <%= @project.credits_enabled? ? Tracker.all.to_json : Tracker.no_credits.to_json %>

      var trackers_object = {};

      for(var i=0; i<trackers.length; i++) {
	  trackers_object[trackers[i].name] = trackers[i];
      }

      return trackers_object;

  }();

  var hourly_types = <%= @project.hourly_types.to_json(:methods => :name_with_rates) %>

  $('document').ready(function(){
      start();
  });
  
</script>






<div id='flyovers' style="display:none;">

<div id="help_description" style="display:none;">
  <div class="tip" style="width:180px">
    <strong>Description</strong><br>
    A request's description should contain the criteria for the acceptance of the request.<br>
    It should clearly answer the question: <strong>How exactly will we measure that this request is done?</strong> This may take the form of user requirements, acceptance tests, a link to an external document, etc.
  </div>
</div>

<div id="help_requestid" style="display:none;">
  <div class="tip" style="width:180px">
    <strong>Permalink</strong><br>
    You can copy the link below and use it to directly link to this request
  </div>
</div>

<div id="help_feature" style="display:none;">
  <div class="tip" style="width:300px">
    <strong>There are 6 types of requests:</strong><br><br>
    A <strong>Feature</strong> is a request that provides verifiable value to the team's customer. Usually it is requested by the customer. The customer can be an internal customer to the enterprise.<br><br> 
    A <strong>Chore</strong> is a request that does not provide verifiable value to the team's customer but is deemed necessary by the team in order to keep moving forward. Usually it is not requested by the customer, but internally by the team.<br><br>
    A <strong>Bug</strong> is a request that describes a problem in some previously accepted request.<br><br>
    A <strong>Gift</strong> is a request to give a single user a gift of a certain amount of credits. This is usually for a contribution that hasn't yet been recognized.<br>Gift items (and their author, description, votes, comments...etc.) are not visible by the gift recipient. When the gift is delivered, all they will be told is the value of the gift and the workstream it's a part of.<br><br> 
    An <strong>Expense</strong> is used for actual expense items. They have a fixed value, and cannot be estimated or joined. Expenses are immediately reimbursed after they are accepted, and the don't show up in retrospectives.'<br>
    A <strong>Recurring</strong> request occurs for repeating needs. Once a recurring request is finished, a new copy of the request is generated and added to the open pane. Recurring requests are included in retrospectives.'<br>
  </div>
</div>

<div id="help_estimate" style="display:none;">
  <div class="tip" style="width:300px">
    <strong>Estimates</strong><br>
    Ideas are estimated in Points. A Point is a team-specific measurement of the effort required to get the request done. Estimates are used to calculate the budget for the request.
  </div>
</div>

<div id="help_panel_new" style="display:none;">
  <div class="tip" style="width:300px">
    <strong>New Ideas</strong><br>
      New requests are fresh off of somebody's brain. They are ripe for discussion and consideration. <br><br>
      At this stage, it's too early to try to prioritize the work. You should mainly focus on giving a new request your thumbs up (or down) indicating wether or not you think it would be useful to get it done.<br><br> And make sure that it is a concise, measurable and realistic request. This is also a good time to ensure that acceptance criteria is clear for this requests i.e. there's an indication of how the team will know that the request is done.<br><br>Once people have agreed that an idea needs to be implemented, it's now a matter of sizing them up by assigning them a number of points.<br> Once enough members have weighed in the request is moved to the open Queue.
  </div>
</div>

<div id="help_panel_estimate" style="display:none;">
  <div class="tip" style="width:300px">
    <strong>Ideas In Estimation</strong><br>
  </div>
</div>

<div id="help_panel_inprogress" style="display:none;">
  <div class="tip" style="width:300px">
    <strong>Ideas In Progress</strong><br>
      In Progress requests are owned by someone who is actively working on them. All in progress requests have a maximum delivery time of 30 days. <br><br> Any request that has been in progress for more than 30 days is assumed abandoned and gets automatically pulled back into the "open" queue.
  </div>
</div>

<div id="help_panel_open" style="display:none;">
  <div class="tip" style="width:300px">
    <strong>Open Ideas</strong><br>
      These requests are ready to be prioritized, started or canceled. <br>
      To prioritize a request click the up button. Every time a user prioritizes a request, it climbs higher up the queue.
      Only the highest requests (ranked by priority) can be started. As well as all request estimated at zero points<br><br>
      If a request hasn't been prioritized by anyone and has been sitting in the queue for more than a month you have the option of canceling it. <br>
  </div>
</div>

<div id="help_panel_done" style="display:none;">
  <div class="tip" style="width:300px">
    <strong>Done Ideas</strong><br>
      Once a request is finished its marked Done. Citizens now vote on wether or not the request has met its acceptance criteria.<br><br> Each citizen gets one vote to accept or reject a finished request. Once 3 days have passed after the last vote the request is either permanently accepted or rejected based on a tally of the votes. <br>If there's an equal number of accepts and rejects the request is considered rejected.
  </div>
</div>

<div id="help_panel_canceled" style="display:none;">
  <div class="tip" style="width:300px">
    <strong>Canceled Ideas</strong><br>
      If a request hasn't been prioritized by anyone and has been sitting in the queue for more than a month, anyone team member can cancel it.<br><br>
      Once a request has been canceled, anyone can re-open it, effectively pushing it back as a new item for reconsideration.
  </div>
</div>

<div id="help_panel_unknown" style="display:none;">
  <div class="tip" style="width:300px">
    <strong>Unsorted Ideas</strong><br>
    Legacy requests that don't belong in the system anymore. Think of them as bugs in the matrix!
  </div>
</div>

</div>
</div>

<% content_for :footer do %>
<!-- footer -->
<!-- <div class="gt-footer">
  <div class="gt-footer-inner">
  <p>Powered by <a href="http://BetterMeans.com" target="new">BetterMeans.com</a> <%#= Date.today.year %>  <a href="http://creativecommons.org/licenses/by-sa/3.0/" target="new">[cc] CreativeCommons Attribution-Share Alike</a></p>
  </div>
</div> -->
<!-- /footer -->

<% end %>